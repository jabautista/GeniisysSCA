<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="GIACDirectPremCollns">
	
	<parameterMap class="map" id="validateBillNoMap">
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="policyNo"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="policyId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="lineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="OUT" />
		<parameter property="sublineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="OUT" />
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="issueYear"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="polSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="endtSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="endtType"		jdbcType="VARCHAR" 	javaType="java.lang.String"		mode="OUT" />
		<parameter property="polFlag"		jdbcType="VARCHAR" 	javaType="java.lang.String"		mode="OUT" />
		<parameter property="assdNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="assdName"		jdbcType="VARCHAR" 	javaType="java.lang.String"		mode="OUT" />
		<parameter property="currRt"		jdbcType="INTEGER" 	javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="msgAlert"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="currCd"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
	</parameterMap>
	
	<parameterMap class="map" id="validateOpenPolicy">
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="msgAlert"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
	</parameterMap>
	
	<parameterMap class="map" id="getInvoiceListingMap1">
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="tranType"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="instNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="refInvNo"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="policyId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="lineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="sublineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="polIssCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="issueYy"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="polSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="polRenewNo"	jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="endtIssCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="endtYy"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="endtSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="endtType"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="OUT" />
		<parameter property="refPolNo"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="OUT" />
		<parameter property="assdNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="assdName"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="intmNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="intmName"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="collectionAmt"	jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="premAmt"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="taxAmt"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="collectionAmt1" jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="premAmt1"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="taxAmt1"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="tranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="OUT" />
		<parameter property="paytRefNo"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
	</parameterMap>
	
	<resultMap class="java.util.HashMap" id="getInvoiceListingMap">
		<result column="b140_iss_cd"      		property="issCd" />
		<result column="b140_prem_seq_no"      	property="premSeqNo" />
		<result column="transaction_type"     	property="tranType" />
		<result column="inst_no"      			property="instNo" />
		<result column="ref_inv_no"      		property="refInvNo" />
		<result column="policy_id"      		property="policyId" />
		<result column="line_cd"      			property="lineCd" />
		<result column="subline_cd"      		property="sublineCd" />
		<result column="pol_iss_cd"      		property="polIssCd" />
		<result column="issue_yy"      			property="issueYy" />
		<result column="pol_seq_no"     		property="polSeqNo" />
		<result column="pol_renew_no"     		property="polRenewNo" />
		<result column="endt_iss_cd"      		property="endtIssCd" />
		<result column="endt_yy"      			property="endtYy" />
		<result column="endt_seq_no"      		property="endtSeqNo" />
		<result column="endt_type"      		property="endtType" />
		<result column="ref_pol_no"      		property="refPolNo" />
		<result column="assd_no"      			property="assdNo" />
		<result column="assd_name"      		property="assdName" />
		<result column="intm_no"      			property="intmNo" />
		<result column="intm_name"      		property="intmName" />
		<result column="collection_amt"  		property="collectionAmt" />
		<result column="premium_amt"      		property="premAmt" />
		<result column="tax_amt"      			property="taxAmt" />
		<result column="collection_amt1" 		property="collectionAmt1" />
		<result column="premium_amt1"      		property="premAmt1" />
		<result column="tax_amt1"      			property="taxAmt1" />
		<result column="tran_id"      			property="tranId" />
		<result column="payt_ref_no"      		property="paytRefNo" />
		<result column="currency_rt"      		property="currRt" />
		<result column="policy_no"				property="policyNo"/><!-- added by alfie 12.15.2010 -->
		<result column="currency_cd"			property="currCd"/>
		<result column="prem_vatable"			property="premVatable" />
		<result column="prem_vat_exempt"		property="premVatExempt" />
		<result column="prem_zero_rated"		property="premZeroRated" />  
		<result column="rev_gacc_tran_id"		property="revGaccTranId" />
	</resultMap>
	
	<resultMap class="java.util.HashMap" id="getInvoiceListingTableGridMap">
		<result column="b140_iss_cd"      		property="issCd" />
		<result column="b140_prem_seq_no"      	property="premSeqNo" />
		<result column="transaction_type"     	property="tranType" />
		<result column="inst_no"      			property="instNo" />
		<result column="ref_inv_no"      		property="refInvNo" />
		<result column="policy_id"      		property="policyId" />
		<result column="line_cd"      			property="lineCd" />
		<result column="subline_cd"      		property="sublineCd" />
		<result column="pol_iss_cd"      		property="polIssCd" />
		<result column="issue_yy"      			property="issueYy" />
		<result column="pol_seq_no"     		property="polSeqNo" />
		<result column="pol_renew_no"     		property="polRenewNo" />
		<result column="endt_iss_cd"      		property="endtIssCd" />
		<result column="endt_yy"      			property="endtYy" />
		<result column="endt_seq_no"      		property="endtSeqNo" />
		<result column="endt_type"      		property="endtType" />
		<result column="ref_pol_no"      		property="refPolNo" />
		<result column="assd_no"      			property="assdNo" />
		<result column="assd_name"      		property="assdName" />
		<result column="intm_no"      			property="intmNo" />
		<result column="intm_name"      		property="intmName" />
		<result column="collection_amt"  		property="collAmt" />
		<result column="premium_amt"      		property="premAmt" />
		<result column="tax_amt"      			property="taxAmt" />
		<result column="collection_amt1" 		property="collectionAmt1" />
		<result column="premium_amt1"      		property="premAmt1" />
		<result column="tax_amt1"      			property="taxAmt1" />
		<result column="tran_id"      			property="tranId" />
		<result column="payt_ref_no"      		property="paytRefNo" />
		<result column="currency_rt"      		property="currRt" />
		<result column="policy_no"				property="policyNo"/><!-- added by alfie 12.15.2010 -->
		<!-- <result column="bill_no"				property="billNo"/> -->
		<result column="currency_cd"			property="currCd"/>
		<result column="prem_vatable"			property="premVatable" />
		<result column="prem_vat_exempt"		property="premVatExempt" />
		<result column="prem_zero_rated"		property="premZeroRated" />  
		<result column="rev_gacc_tran_id"		property="revGaccTranId" />
		<result column="rownum_"				property="rowNum"/>
		<result column="count_"					property="rowCount"/>
	</resultMap>
	
	<parameterMap class="map" id="taxDefaultMap">
		<parameter property="tranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="tranType"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"	    	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="instNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="fundCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="paramPremAmt"	jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="collnAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="premAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="INOUT" />
		<parameter property="taxAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="INOUT" />
		<parameter property="premVatExempt" jdbcType="NUMERIC"  javaType="java.math.BigDecimal" mode="INOUT" />
		<parameter property="giacTaxCollnCur"	jdbcType="ORACLECURSOR"	javaType="java.sql.ResultSet"	resultMap="GIACTaxCollns.GIACTaxCollnsResultMap" mode="OUT" />
	</parameterMap>
	
	<parameterMap class="map" id="taxDefaultMap2">
		<parameter property="tranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="revTranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="tranType"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"	    	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="instNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="fundCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="paramPremAmt"	jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="collnAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="premAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="INOUT" />
		<parameter property="taxAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="INOUT" />
		<parameter property="premVatExempt" jdbcType="NUMERIC"  javaType="java.math.BigDecimal" mode="INOUT" />
		<parameter property="giacTaxCollnsCur"	jdbcType="ORACLECURSOR"	javaType="java.sql.ResultSet"	resultMap="GIACTaxCollns.GIACTaxCollnsResultMap" mode="OUT" />
	</parameterMap>
	
	<parameterMap class="map" id="taxDefaultMap3"> 
		<parameter property="tranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="revTranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="tranType"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"	    	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="instNo"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="fundCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="collnAmt"		jdbcType="INTEGER"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="premVatExempt" jdbcType="NUMERIC"  javaType="java.math.BigDecimal" mode="INOUT" />
		<parameter property="giacTaxCollnCur"	jdbcType="ORACLECURSOR"	javaType="java.sql.ResultSet"	resultMap="GIACTaxCollns.GIACTaxCollnsResultMap" mode="OUT" />
	</parameterMap> <!--modified by koks: 09.18.2015  change giacTaxCollnsCur to giacTaxCollnCur -->
	
	<!--added by alfie: 12.22.2010  -->
	<parameterMap class="map" id="checkPremiumPaytForSpecialMap">
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="IN"/>
		<parameter property="premSeqNo"		jdbcType="INTEGER"	javaType="java.lang.Integer" 	mode="IN"/>
		<parameter property="msgAlert" 		jdbcType="VARCHAR" 	javaType="java.lang.String" 	mode="OUT"/>
	</parameterMap>
	
	<resultMap id="getDirectPremCollnsDtlsMap" class="java.util.HashMap">
		<result column="gacc_tran_id" 		property="gaccTranId" />
		<result column="transaction_type" 	property="tranType" />
		<result column="b140_iss_cd" 		property="issCd" />
		<result column="b140_prem_seq_no" 	property="premSeqNo" />
		<result column="inst_no" 			property="instNo" />
		<result column="collection_amt" 	property="collAmt" />
		<result column="premium_amt" 		property="premAmt" />
		<result column="tax_amt" 			property="taxAmt" />
		<result column="or_print_tag" 		property="orPrintTag" />
		<result column="particulars" 		property="particulars" />
		<result column="currency_cd" 		property="currCd" />
		<result column="convert_rate" 		property="convRate" />
		<result column="foreign_curr_amt"	property="forCurrAmt" />
		<result column="assd_name"          property="assdName"  />
		<result column="assd_no"          	property="assdNo"  />
		<result column="policy_id"          property="policyId"  />
		<result column="line_cd"          	property="lineCd"  />
		<result column="subline_cd"         property="sublineCd"  />
		<result column="pol_iss_cd"         property="polIssCd"  />
		<result column="issue_yy"           property="issueYy"  />
		<result column="pol_seq_no"         property="polSeqNo"  />
		<result column="endt_seq_no"        property="endtSeqNo"  />
		<result column="endt_type"          property="endtType"  />
		<result column="policy_no"			property="policyNo" /><!-- added by alfie 12.08.2010  -->
		<result column="balance_amt_due"	property="balanceAmtDue" /> <!-- added by Tonio May 31, 2011 -->
		<result column="prem_balance_due"	property="premBalanceDue" /> <!-- added by Tonio May 31, 2011 -->
		<result column="inc_tag" 			property="incTag"/> <!-- added by D.Alcantara Feb 13, 2012 -->
		<result column="comm_payt_sw" 		property="commPaytSw"/>
		<result column="max_colln_amt" 		property="maxCollAmt"/>
		<result column="prem_vatable"		property="premVatable" />
		<result column="prem_vat_exempt"	property="premVatExempt" />
		<result column="prem_zero_rated"	property="premZeroRated" />  
		<result column="rev_gacc_tran_id"	property="revGaccTranId" />
	</resultMap>
	
	<resultMap id="getGdpcTableGridResultMap" extends="getDirectPremCollnsDtlsMap" class="java.util.HashMap" >
		<result column="rownum_" property="rowNum" />
		<result column="count_" property="rowCount" />
	</resultMap>
	
	<resultMap id="relatedDirectPremCollnsMap" class="com.geniisys.giac.entity.GIACDirectPremCollns">
		<result column="premium_amt"          property="premAmt"/>
		<result column="tax_amt"        	  property="taxAmt"/>
		<result column="collection_amt"       property="collAmt"/>
		<result column="gacc_tran_id"         property="gaccTranId"/>
		<result column="transaction_type"     property="tranType"/>
		<result column="b140_iss_cd"          property="issCd"/>
		<result column="b140_prem_seq_no"     property="premSeqNo"/>
		<result column="ref_no"         	  property="refNo"/>
		<result column="tran_date"	          property="tranDate"/>
		<result column="total_prem"	          property="totalPrem"/>
		<result column="total_tax"	          property="totalTax"/>
		<result column="total_collection"	  property="totalCollection"/>
		<result column="inst_no"			  property="instNo"/>
		<result column="user_id"			  property="userId"/>
		<result column="particulars"		  property="particulars"/>
		<result column="last_update"		  property="lastUpdate"/>
		<result column="rownum_"			  property="rowNum"/>			
		<result column="count_"				  property="rowCount"/>
	</resultMap>
	
	<parameterMap class="java.util.HashMap" id="validateGIACS007PremSeqNoMap">
		<parameter property="userId"     	jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="IN" />
		<parameter property="tranId"		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="premSeqNo"     jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="issCd"     	jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="IN" />
		<parameter property="tranType"     	jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="message"     	jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="OUT" />
		<parameter property="alertMsg"     	jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="OUT" />
	</parameterMap>
	
	<procedure id="validateBillNo" parameterMap="validateBillNoMap">
		{CALL validate_bill_no(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>	
	
	<procedure id="validateOpenPolicy" parameterMap="validateOpenPolicy">
		{CALL validate_open_policy(?, ?, ?)}
	</procedure>	
	
	<procedure id="getInvoiceListing" resultMap="getInvoiceListingMap" parameterClass="java.util.HashMap">
		SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#, #premSeqNo#, #tranType#, #instNo#))
	</procedure>
	
	<procedure id="getInvoiceListingForPartial" resultMap="getInvoiceListingMap" parameterClass="java.util.HashMap">
		SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#, #premSeqNo#, #tranType#, #instNo#))
		 WHERE REV_GACC_TRAN_ID = nvl(#revGaccTranId#,REV_GACC_TRAN_ID)
	</procedure>
	
	<procedure id="getDefaultTaxValueType1" parameterMap="taxDefaultMap">
		{CALL tax_default_value_type1(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<procedure id="getDefaultTaxValueType2" parameterMap="taxDefaultMap2">
		{CALL tax_default_value_type2(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<procedure id="getDefaultTaxValueType3" parameterMap="taxDefaultMap">
		{CALL tax_default_value_type3(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<procedure id="getDefaultTaxValueType4" parameterMap="taxDefaultMap2">
		{CALL tax_default_value_type4(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<procedure id="reverseTranType1Or3" parameterMap="taxDefaultMap3">
		{CALL REVERSE_TRAN_TYPE_1_OR_3(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<insert id="saveDirectPremCollnsDtls" parameterClass="com.geniisys.giac.entity.GIACDirectPremCollns">
		BEGIN
			giis_users_pkg.app_user := #appUser#;
			giac_direct_prem_collns_pkg.save_direct_prem_collns_dtls(
				#gaccTranId#, #tranType#, #issCd#,
				#premSeqNo#, #instNo#, #collAmt#,
				#premAmt#, #taxAmt#, #orPrintTag#,
				#particulars#, #currCd#, #convRate#,	
				#forCurrAmt#, #premVatable#, #premVatExempt#, 
				#premZeroRated#, #revGaccTranId#
			);
		END;
	</insert>
	
	<select id="getDirectPremCollnsDtls" parameterClass="java.lang.Integer" resultMap="getDirectPremCollnsDtlsMap">
		SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_direct_prem_collns_dtls(#gacc_tran_id#))
	</select>
	
	<delete id="delPremCollnsDtls" parameterClass="com.geniisys.giac.entity.GIACDirectPremCollns">
		BEGIN
			giis_users_pkg.app_user := #appUser#;
			giac_direct_prem_collns_pkg.delete_direct_prem_collns_dtls(
				#tranType#, #issCd#, #premSeqNo#, #instNo#, #gaccTranId#
			);
		END;
	</delete>
	
	<procedure id="generateTaxDefaults" parameterClass="java.util.HashMap">
		BEGIN
			giis_users_pkg.app_user := #appUser#;
			giac_direct_prem_collns_pkg.generate_tax_defaults(
					#gaccTranId#, #tranType#, #issCd#, #premSeqNo#, 
					#instNo#, #fundCd#, #paramPremAmt#, #collnAmt#, #premAmt#,
					#taxAmt#, #sumTaxTotal#, #revGaccTranId#
					);
		END;
		<!-- premAmt replaced to prevPremAmt, d.alcantara -->
	</procedure>
	
	<!--added by alfie: 12.22.2010  -->
	<procedure id="checkPremiumPaytForSpecial" parameterMap="checkPremiumPaytForSpecialMap">
		{CALL check_premium_payt_for_special(?, ?, ?)}
	</procedure>
	
	<!-- added by alfie: 02.08.2011 -->
	<procedure id="getInvoiceListingTableGrid" resultMap="getInvoiceListingTableGridMap" parameterClass="java.util.HashMap">
		SELECT /*+ NO_CPU_COSTING */ * 
          FROM (SELECT rownum rownum_, 
                       b.count_,
                       a.*,
                       a.b140_iss_cd||' - '||LPAD(b140_prem_seq_no ,12,'0') bill_no
                  FROM (SELECT * 
                          FROM TABLE (giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#, NVL(#filter.premSeqNo#,#premSeqNo#), #tranType#, null))
                         WHERE inst_no = NVL(#filter.instNo#, inst_no)
                           AND UPPER(assd_name) LIKE UPPER(NVL(#filter.assdName#, assd_name))
                           AND NVL(UPPER(intm_name),'%') LIKE NVL(UPPER(NVL(#filter.intmName#, intm_name)),'%') <!--added NVL to handle records with null intm_name - christian 08.30.2012 -->
                           AND UPPER(line_cd) LIKE UPPER(NVL(#filter.lineCd#, line_cd)) <!-- bonok :: 09.17.2012 -->
                           AND UPPER(subline_cd) LIKE UPPER(NVL(#filter.sublineCd#, subline_cd))
                           AND UPPER(pol_iss_cd) LIKE UPPER(NVL(#filter.polIssCd#, pol_iss_cd))
                           AND UPPER(issue_yy) LIKE UPPER(NVL(#filter.issueYy#, issue_yy))
                           AND UPPER(pol_seq_no) LIKE UPPER(NVL(#filter.polSeqNo#, pol_seq_no))
                           AND NVL(UPPER(endt_iss_cd),'%') LIKE NVL(UPPER(NVL(#filter.endtIssCd#, endt_iss_cd)),'%')
                           AND NVL(UPPER(endt_yy),'%') LIKE NVL(UPPER(NVL(#filter.endtYy#, endt_yy)),'%')
                           AND NVL(UPPER(endt_seq_no),'%') LIKE NVL(UPPER(NVL(#filter.endtSeqNo#, endt_seq_no)),'%') <!-- bonok :: 09.17.2012 -->
                          ) a, 
                       (SELECT count(*) count_ 
                          FROM TABLE (giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#, NVL(#filter.premSeqNo#,#premSeqNo#), #tranType#, null))
                         WHERE inst_no = NVL(#filter.instNo#, inst_no)
                           AND UPPER(assd_name) LIKE UPPER(NVL(#filter.assdName#, assd_name))
                           AND NVL(UPPER(intm_name),'%') LIKE NVL(UPPER(NVL(#filter.intmName#, intm_name)),'%') <!--added NVL to handle records with null intm_name - christian 08.30.2012 -->
                           AND UPPER(line_cd) LIKE UPPER(NVL(#filter.lineCd#, line_cd)) <!-- bonok :: 09.17.2012 -->
                           AND UPPER(subline_cd) LIKE UPPER(NVL(#filter.sublineCd#, subline_cd))
                           AND UPPER(pol_iss_cd) LIKE UPPER(NVL(#filter.polIssCd#, pol_iss_cd))
                           AND UPPER(issue_yy) LIKE UPPER(NVL(#filter.issueYy#, issue_yy))
                           AND UPPER(pol_seq_no) LIKE UPPER(NVL(#filter.polSeqNo#, pol_seq_no))
                           AND NVL(UPPER(endt_iss_cd),'%') LIKE NVL(UPPER(NVL(#filter.endtIssCd#, endt_iss_cd)),'%')
                           AND NVL(UPPER(endt_yy),'%') LIKE NVL(UPPER(NVL(#filter.endtYy#, endt_yy)),'%')
                           AND NVL(UPPER(endt_seq_no),'%') LIKE NVL(UPPER(NVL(#filter.endtSeqNo#, endt_seq_no)),'%') <!-- bonok :: 09.17.2012 -->
                          ) b) 
		 WHERE rownum_ BETWEEN #from# AND #to#		 	
	</procedure>
	
	<select id="getRelatedDirectPremCollns" resultMap="relatedDirectPremCollnsMap" parameterClass="java.util.HashMap">
		SELECT *       
  		  FROM (SELECT rownum rownum_ ,b.count_,total_prem,total_tax,total_collection,a.*     
          		  FROM (SELECT * FROM TABLE(GIAC_DIRECT_PREM_COLLNS_PKG.get_related_prem_collns(#issCd#,#premSeqNo#))) a,
               		   (SELECT count(*) count_ FROM TABLE(GIAC_DIRECT_PREM_COLLNS_PKG.get_related_prem_collns(#issCd#,#premSeqNo#))) b,
                       (SELECT sum(premium_amt) total_prem FROM TABLE(GIAC_DIRECT_PREM_COLLNS_PKG.get_related_prem_collns(#issCd#,#premSeqNo#))) c,
                       (SELECT sum(tax_amt) total_tax FROM TABLE(GIAC_DIRECT_PREM_COLLNS_PKG.get_related_prem_collns(#issCd#,#premSeqNo#))) d,
                       (SELECT sum(collection_amt) total_collection FROM TABLE(GIAC_DIRECT_PREM_COLLNS_PKG.get_related_prem_collns(#issCd#,#premSeqNo#))) e)
                 WHERE rownum_ BETWEEN #from# AND #to#
	</select>
	
	<procedure id="getPolicyInvoices" resultMap="getInvoiceListingMap" parameterClass="java.util.HashMap">
		SELECT * FROM 
		 TABLE(giac_direct_prem_collns_pkg.get_inv_from_policy(#lineCd#, 
		 			#sublineCd#, #issCd#, #issYear#, #polSeqNo#, #renewNo#, #refPolNo#, #dueTag#))
	</procedure>
	
	<procedure id="validateGIACS007PremSeqNo" parameterMap="validateGIACS007PremSeqNoMap">
		BEGIN
			GIIS_USERS_PKG.app_user := ?;
			GIAC_DIRECT_PREM_COLLNS_PKG.validate_giacs007_prem_seq_no(?, ?, ?, ?, ?, ?);
		END;
	</procedure>
	
	<parameterMap class="java.util.HashMap" id="setPremTaxTranTypeMap">
		<parameter property="issCd"     		jdbcType="VARCHAR"	javaType="java.lang.String" 	mode="IN" />
		<parameter property="premSeqNo"			jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="tranType"     		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="instNo"     		jdbcType="INTEGER"	javaType="java.lang.Integer"	mode="IN" />
		<parameter property="premAmt"     		jdbcType="NUMERIC"	javaType="java.math.BigDecimal"	mode="IN" />
		<parameter property="premVatable"     	jdbcType="NUMERIC"	javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="premVatExempt"     jdbcType="NUMERIC"	javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="premZeroRated"     jdbcType="NUMERIC"	javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="maxPremVatable"    jdbcType="NUMERIC"	javaType="java.math.BigDecimal"	mode="OUT" />
	</parameterMap>
	
	<procedure id="setPremTaxTranType" parameterMap="setPremTaxTranTypeMap" >
		BEGIN
			GIAC_DIRECT_PREM_COLLNS_PKG.set_premtax_tran_type(?, ?, ?, ?, ?, ?, ?, ?, ?);
		END;
	</procedure>
	
	<select id="checkIfInvoiceExists" parameterClass="map" resultClass="string">
		SELECT GIAC_DIRECT_PREM_COLLNS_PKG.check_existing_installment(#issCd#, #premSeqNo#, #tranType#, #instNo#) checkInvoice 
		  FROM DUAL
	</select>
		
	<select id="getGdpcTableGrid" resultMap="getGdpcTableGridResultMap">
		SELECT *
		  FROM (SELECT rownum rownum_, 
		               b.count_, 
		               a.* 
		          FROM (SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_direct_prem_collns_dtls(#gaccTranId#))
		          		<dynamic prepend="WHERE ">
					  		  	<isNotNull property="assdName" prepend="AND">
					  		  		UPPER(assd_name) LIKE  UPPER(#assdName#)
					  		  	</isNotNull>
					  		  	<isNotNull property="tranType" prepend="AND">
					  		  		transaction_type = #tranType#
					  		  	</isNotNull>
					  		  	<isNotNull property="issCd" prepend="AND">
					  		  		b140_iss_cd = #issCd#
					  		  	</isNotNull>
					  		  	<isNotNull property="premSeqNo" prepend="AND">
					  		  		b140_prem_seq_no = #premSeqNo#
					  		  	</isNotNull>
					  		  	<isNotNull property="instNo" prepend="AND">
									inst_no = #instNo#
					  		  	</isNotNull>
					  		  	<isNotNull property="collAmt" prepend="AND">
									collection_amt LIKE  #collAmt#
					  		  	</isNotNull>
					  		  	<isNotNull property="premAmt" prepend="AND">
									premium_amt LIKE  #premAmt#
					  		  	</isNotNull>
					  		  	<isNotNull property="taxAmt" prepend="AND">
									tax_amt LIKE #taxAmt#
					  		  	</isNotNull>
					  	</dynamic>
		          		<isEqual property="sortColumn" compareValue="assdName">
			            	ORDER BY assd_name
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="tranType">
			            	ORDER BY transaction_type
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="issCd">
			            	ORDER BY b140_iss_cd
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="premSeqNo">
			            	ORDER BY b140_prem_seq_no
			          	</isEqual>  
			          	<isEqual property="sortColumn" compareValue="instNo">
			            	ORDER BY inst_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="collAmt">
			            	ORDER BY collection_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="premAmt">
			            	ORDER BY premium_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="taxAmt">
			            	ORDER BY tax_amt
			          	</isEqual>
			           	<isNotNull property="sortColumn">
			              	<isEqual property="ascDescFlg" compareValue="ASC">
			              		ASC
			              	</isEqual>
			              	<isEqual property="ascDescFlg" compareValue="DESC">
			              		DESC
			              	</isEqual>
			            </isNotNull>  
		                  ) a, 
		               (SELECT count(*) count_ 
		                  FROM TABLE(giac_direct_prem_collns_pkg.get_direct_prem_collns_dtls(#gaccTranId#))
		                  <dynamic prepend="WHERE ">
					  		  	<isNotNull property="assdName" prepend="AND">
					  		  		UPPER(assd_name) LIKE  UPPER(#assdName#)
					  		  	</isNotNull>
					  		  	<isNotNull property="tranType" prepend="AND">
					  		  		transaction_type = #tranType#
					  		  	</isNotNull>
					  		  	<isNotNull property="issCd" prepend="AND">
					  		  		b140_iss_cd = #issCd#
					  		  	</isNotNull>
					  		  	<isNotNull property="premSeqNo" prepend="AND">
					  		  		b140_prem_seq_no = #premSeqNo#
					  		  	</isNotNull>
					  		  	<isNotNull property="instNo" prepend="AND">
									inst_no = #instNo#
					  		  	</isNotNull>
					  		  	<isNotNull property="collAmt" prepend="AND">
									collection_amt LIKE  #collAmt#
					  		  	</isNotNull>
					  		  	<isNotNull property="premAmt" prepend="AND">
									premium_amt LIKE  #premAmt#
					  		  	</isNotNull>
					  		  	<isNotNull property="taxAmt" prepend="AND">
									tax_amt LIKE #taxAmt#
					  		  	</isNotNull>
					  	</dynamic>
					  	) b) 
		 WHERE rownum_ BETWEEN #from# AND #to#
	</select>
	
	<resultMap id="getPremCollnsTGResultMap" class="java.util.HashMap">
		<result column="gacc_tran_id" 				property="gaccTranId" />
		<result column="dsp_peril_cd" 				property="dspPerilCd" />
		<result column="dsp_peril_name" 			property="dspPerilName" />
		<result column="dsp_prem_amt" 			property="dspPremAmt" />
		<result column="b140_prem_seq_no" 		property="b140PremSeqNo" />
		<result column="b140_iss_cd" 				property="b140IssCd" />
		<result column="rownum_" 					property="rowNum" />
		<result column="count_" 						property="rowCount" />
	</resultMap>
	
	<select id="getPremCollnsTG" resultMap="getPremCollnsTGResultMap">
		SELECT *
		  FROM (SELECT rownum rownum_, 
		               b.count_, 
		               a.* 
		          FROM (SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_prem_collns_listing(#issCd#, #premSeqNo#))
		          		<isEqual property="sortColumn" compareValue="dspPerilCd">
			            	ORDER BY dsp_peril_cd
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="dspPerilName">
			            	ORDER BY dsp_peril_name
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="dspPremAmt">
			            	ORDER BY dsp_prem_amt
			          	</isEqual>
			           	<isNotNull property="sortColumn">
			              	<isEqual property="ascDescFlg" compareValue="ASC">
			              		ASC
			              	</isEqual>
			              	<isEqual property="ascDescFlg" compareValue="DESC">
			              		DESC
			              	</isEqual>
			            </isNotNull>  
		                  ) a, 
		               (SELECT count(*) count_ 
		                  FROM TABLE(giac_direct_prem_collns_pkg.get_prem_collns_listing(#issCd#, #premSeqNo#))) b) 
		 WHERE rownum_ BETWEEN #from# AND #to#
	</select>
	
	<select id="getInvoiceListingTG2" resultMap="getInvoiceListingTableGridMap">
		SELECT *
		  FROM (SELECT rownum rownum_, 
		               b.count_, 
		               a.* 
		          FROM (SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#,#premSeqNo#, #tranType#, #instNo#))
		          		<!-- <dynamic prepend="WHERE "> -->
					  		  	<!-- <isNotNull property="instNo" prepend="AND">
					  		  		inst_no =  #instNo#
					  		  	</isNotNull> -->
					  		<isNotNull property="filter">	
					  	  		WHERE 1=1
					  		  	<isNotEmpty property="refInvNo" prepend="AND">
					  		  		UPPER(ref_inv_no) LIKE UPPER(#refInvNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="collAmt" prepend="AND">
					  		  		collection_amt = #collAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="premAmt" prepend="AND">
					  		  		premium_amt = #premAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="taxAmt" prepend="AND">
									tax_amt = #taxAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="assdName" prepend="AND">
									UPPER(assd_name) LIKE UPPER(#assdName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="intmName" prepend="AND">
									UPPER(intm_name) LIKE UPPER(#intmName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="refPolNo" prepend="AND">
									UPPER(ref_pol_no) LIKE UPPER(#refPolNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtYy" prepend="AND">
									endt_yy = #endtYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtSeqNo" prepend="AND">
									endt_seq_no = #endtSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtIssCd" prepend="AND">
									UPPER(endt_iss_cd) LIKE UPPER(#endtIssCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="issueYy" prepend="AND">
									issue_yy = #issueYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="lineCd" prepend="AND">
									UPPER(line_cd) LIKE UPPER(#lineCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="polSeqNo" prepend="AND">
									pol_seq_no = #polSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="sublineCd" prepend="AND">
									UPPER(subline_cd) LIKE UPPER(#sublineCd#)
					  		  	</isNotEmpty>
					  		</isNotNull>	  	
					  	<!-- </dynamic> -->
		          		<isEqual property="sortColumn" compareValue="issCd premSeqNo">
			            	ORDER BY b140_iss_cd || b140_prem_seq_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="instNo">
			            	ORDER BY inst_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="refInvNo">
			            	ORDER BY ref_inv_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="paytRefNo">
			            	ORDER BY payt_ref_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="collAmt">
			            	ORDER BY collection_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="premAmt">
			            	ORDER BY premium_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="taxAmt">
			            	ORDER BY tax_amt
			          	</isEqual>
			           	<isNotNull property="sortColumn">
			              	<isEqual property="ascDescFlg" compareValue="ASC">
			              		ASC
			              	</isEqual>
			              	<isEqual property="ascDescFlg" compareValue="DESC">
			              		DESC
			              	</isEqual>
			            </isNotNull>  
		                  ) a, 
		               (SELECT count(*) count_ 
		                  FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing(#issCd#,#premSeqNo#, #tranType#, #instNo#))
		                  <!-- <dynamic prepend="WHERE "> -->
					  		  	<!-- <isNotNull property="instNo" prepend="AND">
					  		  		inst_no =  #instNo#
					  		  	</isNotNull> -->
					  		  	<isNotNull property="filter">
					  		  		WHERE 1=1	
						  		  	<isNotEmpty property="refInvNo" prepend="AND">
					  		  		UPPER(ref_inv_no) LIKE UPPER(#refInvNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="collAmt" prepend="AND">
					  		  		collection_amt = #collAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="premAmt" prepend="AND">
					  		  		premium_amt = #premAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="taxAmt" prepend="AND">
									tax_amt = #taxAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="assdName" prepend="AND">
									UPPER(assd_name) LIKE UPPER(#assdName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="intmName" prepend="AND">
									UPPER(intm_name) LIKE UPPER(#intmName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="refPolNo" prepend="AND">
									UPPER(ref_pol_no) LIKE UPPER(#refPolNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtYy" prepend="AND">
									endt_yy = #endtYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtSeqNo" prepend="AND">
									endt_seq_no = #endtSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtIssCd" prepend="AND">
									UPPER(endt_iss_cd) LIKE UPPER(#endtIssCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="issueYy" prepend="AND">
									issue_yy = #issueYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="lineCd" prepend="AND">
									UPPER(line_cd) LIKE UPPER(#lineCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="polSeqNo" prepend="AND">
									pol_seq_no = #polSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="sublineCd" prepend="AND">
									UPPER(subline_cd) LIKE UPPER(#sublineCd#)
					  		  	</isNotEmpty>					  		  	</isNotNull>
					  	<!-- </dynamic> -->
		                  ) b) 
		 WHERE rownum_ BETWEEN #from# AND #to#
	</select>
	
	<parameterMap class="map" id="saveAcctDtlsGIACS007Map">
		<parameter property="appUser" 					jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="gaccTranId" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="transactionType" 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="issCd" 						jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="premSeqNo"				jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="instNo" 					jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="fundCd"					jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="paramPremAmt" 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="collAmt"					jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="premAmt" 				jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="taxAmt"					jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
		<parameter property="sumTaxAmt" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="msg"						jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
	</parameterMap>
	
	<procedure id="saveAcctDtlsGIACS007"  parameterMap="saveAcctDtlsGIACS007Map">
		BEGIN
			GIIS_USERS_PKG.app_user := ?;
			GIAC_DIRECT_PREM_COLLNS_PKG.save_acct_dtls(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
		END;
	</procedure>
	
	<select id="getIncTagForAdvPremPayts" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT get_inc_tag_for_adv_prem_payts(#gaccTranId#, #issCd#, #premSeqNo#) inc_tag FROM DUAL
	</select>
	
	<procedure id="checkAdvPayt" parameterClass="java.util.HashMap">
		BEGIN
			giis_users_pkg.app_user := #appUser#;
			CHECK_ADV_PAYT(#gaccTranId#, #tranType#, #issCd#, 	#premSeqNo#,
						   #instNo#, 	 #policyId#, #premAmt#, #taxAmt#,
						   #appUser#, 	 #assdNo#,   #incTag#);
		END;
	</procedure>
	
	<select id="checkSpecialBill" parameterClass="java.util.HashMap" resultClass="string">
		SELECT giac_direct_prem_collns_pkg.check_special_bill(#issCd#, #premSeqNo#) FROM dual
	</select>
	
	<parameterMap class="map" id="directPremTotalsMap">
		<parameter property="gaccTranId" 			jdbcType="VARCHAR" javaType="java.lang.String" 		mode="IN"/>
		<parameter property="totalCollection"		jdbcType="NUMERIC" javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="totalPremium"			jdbcType="NUMERIC" javaType="java.math.BigDecimal"	mode="OUT" />
		<parameter property="totalTax"				jdbcType="NUMERIC" javaType="java.math.BigDecimal"	mode="OUT" />
	</parameterMap>
	
	<procedure id="getDirectPremTotals" parameterMap="directPremTotalsMap">
		{CALL GIAC_DIRECT_PREM_COLLNS_PKG.get_direct_prem_collns_sum(?,?,?,?)}
	</procedure>
	
	<select id="getInvoiceListingTG3" resultMap="getInvoiceListingTableGridMap">
		<!-- Modified by pjsantos 09/27/2016, for optimization GENQA 2692 -->
		<!--SELECT *
		  FROM (SELECT rownum rownum_,  
		               b.count_, 
		               a.*  
		          FROM (-->SELECT * FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing2(#issCd#,#premSeqNo#, #tranType#, #instNo#,
		                   #refInvNo#, #paytRefNo#, #collAmt#, #premAmt#, #taxAmt#, #assdName#, #intmName#, #refPolNo#, #endtYy#,
		                   #endtSeqNo#, #endtIssCd#, #issueYy#, #lineCd#, #polSeqNo#, #sublineCd#,
		                   #sortColumn#, #ascDescFlg#, #from#, #to#))  
		          	 		<!-- <dynamic prepend="WHERE "> 
					  		  	<isNotNull property="instNo" prepend="AND">
					  		  		inst_no =  #instNo#
					  		  	</isNotNull> 
					  		<isNotNull property="filter">	
					  	             WHERE 1=1
					  		  	<isNotEmpty property="refInvNo" prepend="AND">
					  		  		UPPER(ref_inv_no) LIKE UPPER(#refInvNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="collAmt" prepend="AND">
					  		  		collection_amt = #collAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="premAmt" prepend="AND">
					  		  		premium_amt = #premAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="taxAmt" prepend="AND">
									tax_amt = #taxAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="assdName" prepend="AND">
									UPPER(assd_name) LIKE UPPER(#assdName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="intmName" prepend="AND">
									UPPER(intm_name) LIKE UPPER(#intmName#)
					  		  	 </isNotEmpty>
					  		  	 </dynamic>
					  		  	<isNotEmpty property="refPolNo" prepend="AND">
									UPPER(ref_pol_no) LIKE UPPER(#refPolNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtYy" prepend="AND">
									endt_yy = #endtYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtSeqNo" prepend="AND">
									endt_seq_no = #endtSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtIssCd" prepend="AND">
									UPPER(endt_iss_cd) LIKE UPPER(#endtIssCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="issueYy" prepend="AND">
									issue_yy = #issueYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="lineCd" prepend="AND">
									UPPER(line_cd) LIKE UPPER(#lineCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="polSeqNo" prepend="AND">
									pol_seq_no = #polSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="sublineCd" prepend="AND">
									UPPER(subline_cd) LIKE UPPER(#sublineCd#)
					  		  	</isNotEmpty>
					  		</isNotNull>  	
					  	 </dynamic>
		          		  <isEqual property="sortColumn" compareValue="issCd premSeqNo">
			            	ORDER BY b140_iss_cd || b140_prem_seq_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="instNo">
			            	ORDER BY inst_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="refInvNo">
			            	ORDER BY ref_inv_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="paytRefNo">
			            	ORDER BY payt_ref_no
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="collAmt">
			            	ORDER BY collection_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="premAmt">
			            	ORDER BY premium_amt
			          	</isEqual>
			          	<isEqual property="sortColumn" compareValue="taxAmt">
			            	ORDER BY tax_amt
			          	</isEqual>
			           	<isNotNull property="sortColumn">
			              	<isEqual property="ascDescFlg" compareValue="ASC">
			              		ASC
			              	</isEqual>
			              	<isEqual property="ascDescFlg" compareValue="DESC">
			              		DESC
			              	</isEqual>
			            </isNotNull>  
		                  ) a, 
		               (SELECT count(*) count_ 
		                  FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing2(#issCd#,#premSeqNo#, #tranType#, #instNo#))
		                  --><!-- <dynamic prepend="WHERE "> -->
					  		  	<!-- <isNotNull property="instNo" prepend="AND">
					  		  		inst_no =  #instNo#
					  		  	</isNotNull> -->
					  		  	<!--  <isNotNull property="filter">
					  		  		WHERE 1=1	
						  		  	<isNotEmpty property="refInvNo" prepend="AND">
					  		  		UPPER(ref_inv_no) LIKE UPPER(#refInvNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="collAmt" prepend="AND">
					  		  		collection_amt = #collAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="premAmt" prepend="AND">
					  		  		premium_amt = #premAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="taxAmt" prepend="AND">
									tax_amt = #taxAmt#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="assdName" prepend="AND">
									UPPER(assd_name) LIKE UPPER(#assdName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="intmName" prepend="AND">
									UPPER(intm_name) LIKE UPPER(#intmName#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="refPolNo" prepend="AND">
									UPPER(ref_pol_no) LIKE UPPER(#refPolNo#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtYy" prepend="AND">
									endt_yy = #endtYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtSeqNo" prepend="AND">
									endt_seq_no = #endtSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="endtIssCd" prepend="AND">
									UPPER(endt_iss_cd) LIKE UPPER(#endtIssCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="issueYy" prepend="AND">
									issue_yy = #issueYy#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="lineCd" prepend="AND">
									UPPER(line_cd) LIKE UPPER(#lineCd#)
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="polSeqNo" prepend="AND">
									pol_seq_no = #polSeqNo#
					  		  	</isNotEmpty>
					  		  	<isNotEmpty property="sublineCd" prepend="AND">
									UPPER(subline_cd) LIKE UPPER(#sublineCd#)
					  		  	</isNotEmpty>					  		  	</isNotNull> -->
					  	<!-- </dynamic> -->
		                  <!--  ) b) 	                  
		 WHERE rownum_ BETWEEN #from# AND #to# -->		
	</select>
	
	<select id="getNumberOfInst" resultClass="integer" parameterClass="java.util.HashMap" > 
		<!-- Modified by pjsantos 10/19/2016, GENQA 5787 -->
		SELECT <!--  count(*) count --> count_
		      FROM TABLE(giac_direct_prem_collns_pkg.get_gdcp_invoice_listing2(#issCd#,#premSeqNo#, #tranType#, NULL,
		      NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
                           NULL, NULL, NULL, NULL, NULL, NULL,
                           NULL, NULL, NULL, NULL))
	</select>
	
	<parameterMap class="map" id="GIACS007PolicyMap">
		<parameter property="lineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="sublineCd"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="issCd"			jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="issueYy"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="polSeqNo"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN" />
		<parameter property="renewNo"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN" />
		<parameter property="refPolNo"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="checkDue"		jdbcType="VARCHAR"	javaType="java.lang.String"		mode="IN" />
		<parameter property="endtMessage"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="specMessage"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="openMessage"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="endtProceed"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="specProceed"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
		<parameter property="openProceed"	jdbcType="VARCHAR"	javaType="java.lang.String"		mode="OUT" />
	</parameterMap>
	
	<procedure id="validateGIACS007Policy" parameterMap="GIACS007PolicyMap">
 		{CALL GIAC_DIRECT_PREM_COLLNS_PKG.validate_policy(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
 	</procedure>
 	
 	<select id="checkPreviousInst" parameterClass="map" resultClass="string">
		SELECT GIAC_DIRECT_PREM_COLLNS_PKG.check_previous_installment(#issCd#, #premSeqNo#, #instNo#) checkInvoice 
		  FROM DUAL
	</select>
	
	<procedure id="checkTotalPayments" parameterClass="com.geniisys.giac.entity.GIACDirectPremCollns">
 		{CALL GIAC_DIRECT_PREM_COLLNS_PKG.check_total_payments(#issCd#, #premSeqNo#, #instNo#)}
 	</procedure>
</sqlMap>