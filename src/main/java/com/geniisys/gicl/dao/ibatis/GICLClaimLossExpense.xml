<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="GICLClaimLossExpense">
    <cacheModel id="oneDayClient" type="MEMORY">
        <flushInterval hours="24" />
        <property name="reference-type" value="WEAK" />
    </cacheModel>

    <typeAlias alias="GICLClaimLossExpenseClass" type="com.geniisys.gicl.entity.GICLClaimLossExpense"/>
    
    <resultMap class="GICLClaimLossExpenseClass" id="GICLClaimLossExpenseResultMap">
        <result property="adviceId"                    column="advice_id"        />
        <result property="adviceAmount"                 column="advice_amt"        />
        <result property="cancelSw"                    column="cancel_sw"        />
        <result property="claimId"                    column="claim_id"        />
        <result property="claimClmntNo"                column="clm_clmnt_no"    />
        <result property="claimLossId"                column="claim_loss_id"    />
        <result property="cpiBranchCode"            column="cpi_branch_cd"    />
        <result property="cpiRecNo"                    column="cpi_rec_no"        />
        <result property="currencyCode"                column="currency_cd"    />
        <result property="currencyRate"                column="currenct_rate"    />
        <result property="distSw"                    column="dist_sw"        />
        <result property="distributionType"            column="dist_type"        />
        <result property="exGratiaSw"                column="ex_gratia_sw"    />
        <result property="finalTag"                    column="final_tag"        />
        <result property="groupedItemNo"            column="grouped_item_no"/>
        <result property="historySequenceNumber"    column="hist_seq_no"    />
        <result property="itemNo"                    column="item_no"        />
        <result property="itemStatusCd"                column="item_stat_cd"    />
        <result property="netAmount"                 column="net_amt"        />
        <result property="paidAmount"                 column="paid_amt"        />
        <result property="payeeCode"                column="payee_cd"        />
        <result property="payeeClassCode"            column="payee_class_cd"    />
        <result property="payeeType"                column="payee_type"     />
        <result property="perilCode"                column="peril_cd"        />
        <result property="remarks"                    column="remarks"        />
        <result property="tranDate"                    column="tran_date"        />
        <result property="tranId"                    column="tran_id"        />
        <result property="userId"                    column="userId"            />
    </resultMap>
        
    <resultMap id="GICLClaimLossExpenseResultMap3" class="GICLClaimLossExpenseClass">
        <result property="claimLossId"            column="clm_loss_id"        />
        <result property="payeeType"            column="payee_type"            />
        <result property="payeeTypeDescription" column="payee_type_desc"    />
        <result property="payeeClassCode"        column="payee_class_cd"        />
        <result property="payeeCode"            column="payee_cd"            />
        <result property="payee"                column="payee"                />
        <result property="perilCode"            column="peril_cd"            />
        <result property="perilSname"            column="peril_sname"        />
        <result property="netAmount"            column="net_amt"            />
        <result property="paidAmount"            column="paid_amt"            />
        <result property="adviceAmount"            column="advise_amt"            />
    </resultMap>
    
    <resultMap id="GICLClaimLossExpenseResultMap4" class="GICLClaimLossExpenseClass" extends="BaseEntity.TableGridResultMap">
        <result property="claimId"                column="claim_id"            />
        <result property="claimLossId"            column="clm_loss_id"        />
        <result property="historySequenceNumber" column="hist_seq_no"        />
        <result property="itemNo"                column="item_no"               />
        <result property="perilCode"            column="peril_cd"            />
        <result property="itemStatusCd"            column="item_stat_cd"        />
        <result property="payeeType"            column="payee_type"            />
        <result property="payeeCode"            column="payee_cd"            />
        <result property="payeeClassCode"        column="payee_class_cd"        />
        <result property="paidAmount"            column="paid_amt"            />
        <result property="tranId"                column="tran_id"            />
        <result property="payeeTypeDescription" column="payee_type_desc"    />
        <result property="payeeClassDesc"        column="payee_class_desc"    />
        <result property="payeeLastName"        column="payee_last_name"    />
        <result property="checkNo"                column="check_no"            />
        <result property="checkDate"            column="check_date"            />
        <result property="csrNo"                column="csr_no"                 />
        <result property="adviceId"                column="advice_id"             />
    </resultMap>
    
    <resultMap class="java.util.HashMap" id="GICLClmLossExpResultMap" extends="BaseEntity.TableGridResultMap">
        <result property="claimId"                column="claim_id"/>
        <result property="adviceId"                column="advice_id"/>
        <result property="clmLossId"            column="clm_loss_id"/>
        <result property="tranId"                column="tran_id"/>
        <result property="payeeCd"                column="payee_cd"/>
        <result property="histSeqNo"            column="hist_seq_no"/>
        <result property="itemNo"                column="item_no"/>
        <result property="dspItemTitle"            column="dsp_item_title"/>
        <result property="perilCd"                column="peril_cd"/>
        <result property="dspPerilSname"        column="dsp_peril_sname"/>
        <result property="dspPerilName"            column="dsp_peril_name"/>
        <result property="itemStatCd"            column="item_stat_cd"/>
        <result property="currencyCd"            column="currency_cd"/>
        <result property="currencyRate"            column="currency_rate"/>
        <result property="payeeType"            column="payee_type"/>
        <result property="payeeClassCd"            column="payee_class_cd"/>
        <result property="dspPayeeLastName"        column="dsp_payee_last_name"/>
        <result property="dspPayeeName"            column="dsp_payee_name"/>
        <result property="distSw"                column="dist_sw"/>
        <result property="paidAmt"                column="paid_amt"/>
        <result property="netAmt"                column="net_amt"/>
        <result property="adviseAmt"            column="advise_amt"/>
        <result property="closeFlag"            column="close_flag"/>
        <result property="closeFlag2"			column="close_flag2"/> <!--Added for close flag status of Expense by MAC 02/19/2013-->
    </resultMap>
    
    <resultMap class="GICLClaimLossExpenseClass"   id="GICLClmLossExpResultMap2" extends="BaseEntity.TableGridResultMap">
        <result property="claimId"                   column="CLAIM_ID"/>
        <result property="claimLossId"               column="CLM_LOSS_ID"/>
        <result property="adviceId"                      column="ADVICE_ID"/>
        <result property="historySequenceNumber"   column="HIST_SEQ_NO"/>
        <result property="itemNo"                   column="ITEM_NO"/>
        <result property="perilCode"               column="PERIL_CD"/>
        <result property="groupedItemNo"           column="GROUPED_ITEM_NO"/>
        <result property="claimClmntNo"               column="CLM_CLMNT_NO"/>
        <result property="itemStatusCd"               column="ITEM_STAT_CD"/>
        <result property="clmLossExpStatDesc"       column="LE_STAT_DESC"/>
        <result property="payeeType"               column="PAYEE_TYPE"/>
        <result property="payeeCode"               column="PAYEE_CD"/>
        <result property="payeeClassCode"           column="PAYEE_CLASS_CD"/>
        <result property="exGratiaSw"               column="EX_GRATIA_SW"/>
        <result property="distSw"                   column="DIST_SW"/>
        <result property="cancelSw"                   column="CANCEL_SW"/>
        <result property="paidAmount"               column="PAID_AMT"/>
        <result property="netAmount"               column="NET_AMT"/>
        <result property="adviceAmount"               column="ADVICE_AMT"/>
        <result property="remarks"                   column="REMARKS"/>
        <result property="finalTag"                   column="FINAL_TAG"/>
        <result property="userId"                   column="USER_ID"/>
        <result property="lastUpdate"               column="LAST_UPDATE"/>
        <result property="withLossExpDtl"           column="EXIST_LOSS_EXP_DTL"/>
        <result property="withLossExpTax"           column="EXIST_LOSS_EXP_TAX"/>
        <result property="withLossExpDs"           column="EXIST_LOSS_EXP_DS"/>
        <result property="withLossExpDsNotNegated" column="EXIST_LE_DS_NOT_NEG"/>
        <result property="withGiclAdvice"           column="EXIST_GICL_ADVICE"/>
        <result property="withEvalPayment"           column="EXIST_EVAL_PAYMENT"/>
        <result property="withDepreciation"           column="EXIST_DEPRECIATION"/>
    </resultMap>
    
    <resultMap class="GICLClaimLossExpenseClass" id="getViewHistoryListingResultMap" extends="BaseEntity.TableGridResultMap">
        <result property="claimId"                     column="CLAIM_ID"/>
        <result property="claimLossId"                 column="CLM_LOSS_ID"/>
        <result property="perilCode"                 column="PERIL_CD"/>
        <result property="perilSname"              column="PERIL_SNAME"/>
        <result property="itemStatusCd"              column="ITEM_STAT_CD"/>
        <result property="clmLossExpStatDesc"      column="LE_STAT_DESC"/>
        <result property="payeeCode"              column="PAYEE_CD"/>
        <result property="payee"                  column="PAYEE_LAST_NAME"/>
        <result property="payeeType"              column="PAYEE_TYPE"/>
        <result property="payeeClassCode"          column="PAYEE_CLASS_CD"/>
        <result property="historySequenceNumber"  column="HIST_SEQ_NO"/>
        <result property="distSw"                  column="DIST_SW"/>
        <result property="itemNo"                  column="ITEM_NO"/>
        <result property="paidAmount"              column="PAID_AMT"/>
        <result property="netAmount"              column="NET_AMT"/>
        <result property="adviceAmount"              column="ADVICE_AMT"/>
        <result property="claimClmntNo"              column="CLM_CLMNT_NO"/>
        <result property="exGratiaSw"              column="EX_GRATIA_SW"/>
        <result property="userId"                  column="USER_ID"/>
        <result property="lastUpdate"              column="LAST_UPDATE"/>
    </resultMap>
    
    <resultMap class="java.util.HashMap" id="GenAccLossExpTaxResultMap">
        <result property="payeeCd"         column="payee_cd"/>
        <result property="payeeClassCd" column="payee_class_cd"/>
        <result property="payeeAmount"     column="payee_amount"/>
    </resultMap>
    
    <resultMap class="java.util.HashMap" id="loaCslListResultMap" extends="BaseEntity.TableGridResultMap">
        <result property="payeeCd"                 column="PAYEE_CD"/>
        <result property="payeeClassCd"         column="PAYEE_CLASS_CD"/>
        <result property="classDesc"             column="CLASS_DESC"/>
        <result property="paidAmt"                 column="PAID_AMT"/>
        <result property="payeeName"             column="PAYEE_NAME"/>
        <result property="claimId"                 column="CLAIM_ID"/>
        <result property="clmLossId"             column="CLM_LOSS_ID"/>
        <result property="histSeqNo"             column="HIST_SEQ_NO"/>
        <result property="remarks"                 column="REMARKS"/>
        <result property="evalId"                 column="EVAL_ID"/>
        <result property="loaNo"                 column="LOA_NO"/>
        <result property="cslNo"                 column="CSL_NO"/>
        <result property="tpSw"                 column="TP_SW"/>
        <result property="tpPayeeClassCd"         column="TP_PAYEE_CLASS_CD"/>
        <result property="tpPayeeNo"             column="TP_PAYEE_NO"/>
    </resultMap>
    
    <resultMap class="java.util.HashMap" id="flaDistDtlsMap" extends="BaseEntity.TableGridResultMap">
        <result property="claimId"                 column="CLAIM_ID"/>
        <result property="adviceId"             column="ADVICE_ID"/>
        <result property="lineCd"                 column="LINE_CD"/>
        <result property="shareType"             column="SHARE_TYPE"/>
        <result property="grpSeqNo"             column="GRP_SEQ_NO"/>
        <result property="trtyName"             column="TRTY_NAME"/>
        <result property="paidAmt"                 column="PAID_AMT"/>
        <result property="netAmt"                 column="NET_AMT"/>
        <result property="advAmt"                 column="ADV_AMT"/>
    </resultMap>
    
    <parameterMap class="java.util.HashMap" id="ValClmLossExpTaxParamMap">
        <parameter property="claimId" javaType="java.lang.String" jdbcType="NUMBER" mode="IN"/>
        <parameter property="adviceId" javaType="java.lang.String" jdbcType="NUMBER" mode="IN"/>
        <parameter property="count" javaType="java.lang.Integer" jdbcType="NUMERIC" mode="OUT"/>
        <parameter property="message" javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
    <parameterMap id="copyHistoryParamMap" class="java.util.HashMap">
          <parameter property="userId"          jdbcType="VARCHAR"     javaType="java.lang.String"         mode="IN"/>
          <parameter property="histSeqNo"          jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
          <parameter property="claimId"          jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
          <parameter property="lineCd"          jdbcType="VARCHAR"     javaType="java.lang.String"         mode="IN"/>
        <parameter property="itemNo"            jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
        <parameter property="perilCd"            jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
        <parameter property="groupedItemNo"      jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
        <parameter property="clmClmntNo"      jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
        <parameter property="payeeType"          jdbcType="VARCHAR"     javaType="java.lang.String"         mode="IN"/>
        <parameter property="payeeClassCd"      jdbcType="VARCHAR"     javaType="java.lang.String"         mode="IN"/>
        <parameter property="payeeCd"            jdbcType="INTEGER"    javaType="java.lang.String"         mode="IN"/>
          <parameter property="userId"          jdbcType="VARCHAR"     javaType="java.lang.String"         mode="IN"/>
          <parameter property="msgAlert"          jdbcType="VARCHAR"     javaType="java.lang.String"         mode="OUT"/>
      </parameterMap>
    
    <select id="getClaimLossExpense" resultMap="GICLClaimLossExpenseResultMap">
        SELECT *
          FROM gicl_clm_loss_exp
         WHERE claim_id = #claimId#
           AND clm_loss_id = #claimLossId#
    </select>
    
    <select id="getClaimLossExpenseTransType1" resultMap="GICLClaimLossExpenseResultMap3">
        SELECT  i.clm_loss_id,
                i.payee_type, decode(i.payee_type,'L','Loss','E','Expense') payee_type_desc,
                c.payee_class_cd,          c.payee_cd,   decode(h.payee_first_name, NULL, h.payee_last_name, h.payee_last_name||','||h.payee_first_name||' '||h.payee_middle_name) payee,
                c.peril_cd, d.peril_sname, (c.net_amt * NVL(f.convert_rate,1)) net_amt, c.paid_amt, c.advise_amt  
          FROM giac_direct_claim_payts i, gicl_claims b, gicl_clm_loss_exp c, giis_peril d, giis_payees h, gicl_advice f
         WHERE i.transaction_type = 1
           AND i.claim_id = #claimId#
           AND i.claim_id = b.claim_id
           AND i.claim_id = c.claim_id
           AND i.claim_id = f.claim_id
           AND c.peril_cd = d.peril_cd
           AND i.advice_id = #adviceId#
           AND i.payee_cd = c.payee_cd
           AND i.payee_cd = h.payee_no
           AND d.line_cd = #lineCd#
    </select>
    
    <select id="getClaimLossExpenseTransType2" resultMap="GICLClaimLossExpenseResultMap3">
        SELECT  i.clm_loss_id,
                i.payee_type, decode(i.payee_type,'L','Loss','E','Expense') payee_type_desc,
                c.payee_class_cd,          c.payee_cd,   decode(h.payee_first_name, NULL, h.payee_last_name, h.payee_last_name||','||h.payee_first_name||' '||h.payee_middle_name) payee,
                c.peril_cd, d.peril_sname, (c.net_amt * NVL(f.convert_rate,1)) net_amt, c.paid_amt, c.advise_amt  
          FROM giac_direct_claim_payts i, gicl_claims b, gicl_clm_loss_exp c, giis_peril d, giis_payees h, gicl_advice f
         WHERE i.transaction_type = 2
           AND i.claim_id = #claimId#
           AND i.claim_id = b.claim_id
           AND i.claim_id = c.claim_id
           AND i.claim_id = f.claim_id
           AND c.peril_cd = d.peril_cd
           AND i.advice_id = #adviceId#
           AND i.payee_cd = c.payee_cd
           AND i.payee_cd = h.payee_no
           AND d.line_cd = #lineCd#
    </select>
    
    <insert id="setClaimLossExpense" parameterClass="GICLClaimLossExpenseClass">
        DECLARE
            claimLossExpense gicl_clm_loss_exp%ROWTYPE;
        BEGIN
            claimLossExpense.claim_id        = #claimId#;
            claimLossExpense.clm_loss_id    = #claimLossId#;
            claimLossExpense.hist_seq_no    = #historySequenceNumber#;
            claimLossExpense.item_no        = #itemNo#;
            claimLossExpense.peril_cd        = #perilCode#;
            claimLossExpense.item_stat_cd    = #itemStatusCd#;
            claimLossExpense.payee_type        = #payeeType#;
            claimLossExpense.payee_class_cd    = #payeeClassCode#;
            claimLossExpense.ex_gratia_cd    = #exGratiaSw#;
            claimLossExpense.user_id        = #userId#;
            claimLossExpense.dist_sw        = #distSw#;
            claimLossExpense.paid_amt        = #paidAmount#;
            claimLossExpense.net_amt        = #netAmount#;
            claimLossExpense.advise_amt        = #adviceAmount#;
            claimLossExpense.cpi_rec_no        = #cpiRecNo#;
            claimLossExpense.cpi_branch_cd    = #cpiBranchCode#;
            claimLossExpense.remarks        = #remarks#;
            claimLossExpense.cancel_sw        = #cancelSw#;
            claimLossExpense.advice_id        = #adviceId#;
            claimLossExpense.tran_id        = #tranId#;
            claimLossExpense.dist_type        = #distributionType#;
            claimLossExpense.clm_clmnt_no    = #claimClmntNo#;
            claimLossExpense.final_tag        = #finalTag#;
            claimLossExpense.tran_date        = #tranDate#;
            claimLossExpense.currency_cd    = #currencyCode#;
            claimLossExpense.currency_rate  = #currencyRate#;
            claimLossExpense.grouped_item_no= #groupedItemNo#;
            
            GICL_CLM_LOSS_EXP_PKG.set_clm_loss_exp(claimLossExpense);
        END;
    </insert>
    
    <select id="getClmHistInfo" resultMap="GICLClaimLossExpenseResultMap4">
        SELECT *
          FROM (SELECT rownum rownum_, 
                       b.count_, 
                       a.* 
                  FROM (SELECT * FROM TABLE(gicl_clm_loss_exp_pkg.get_clm_hist_info(#claimId#,#dspItemNo#,#dspPerilCd#))
                              <isNotNull property="sortColumn">
                                  <isEqual property="sortColumn" compareValue="historySequenceNumber">
                                      ORDER BY hist_seq_no
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="itemStatusCd">
                                      ORDER BY item_stat_cd
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="payeeType">
                                      ORDER BY payee_type
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="payeeClassCode payeeCode payeeLastName">
                                      ORDER BY payee_class_cd
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="csrNo">
                                      ORDER BY csr_no
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="paidAmount">
                                      ORDER BY paid_amt
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="ASC">
                                      ASC
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="DESC">
                                      DESC
                                  </isEqual>
                              </isNotNull>) a, 
                       (SELECT count(*) count_ 
                          FROM TABLE(gicl_clm_loss_exp_pkg.get_clm_hist_info(#claimId#,#dspItemNo#,#dspPerilCd#))) b)
         WHERE rownum_ BETWEEN #from# AND #to#
    </select>
    
    <select id="getGICLClmLossExpList" resultMap="GICLClmLossExpResultMap">
        SELECT *
              FROM (SELECT rownum rownum_, 
                           b.count_, a.*
                      FROM (SELECT * 
                              FROM TABLE (gicl_clm_loss_exp_pkg.get_gicl_clm_loss_exp_list(#claimId#, #adviceId#, #lineCd#))
                              <isNotNull property="sortColumn">
                                  <isEqual property="sortColumn" compareValue="histSeqNo">
                                      ORDER BY hist_seq_no
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="itemStatCd">
                                      ORDER BY item_stat_cd
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="itemNo">
                                      ORDER BY item_no
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="dspPerilSname">
                                      ORDER BY dsp_peril_sname
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="currencyRate">
                                      ORDER BY currency_rate
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="payeeType dspPayeeLastName">
                                      ORDER BY payee_type
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="distSw">
                                      ORDER BY dist_sw
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="paidAmt">
                                      ORDER BY paid_amt
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="netAmt">
                                      ORDER BY net_amt
                                  </isEqual>
                                  <isEqual property="sortColumn" compareValue="adviseAmt">
                                      ORDER BY advise_amt
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="ASC">
                                      ASC
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="DESC">
                                      DESC
                                  </isEqual>
                                </isNotNull>) a, 
                           (SELECT count(*) count_
                              FROM TABLE (gicl_clm_loss_exp_pkg.get_gicl_clm_loss_exp_list(#claimId#, #adviceId#, #lineCd#))
                              ) b) 
             WHERE rownum_ BETWEEN #from# AND #to#    
    </select>
    
    <select id="getClmLossExpList" resultMap="GICLClmLossExpResultMap2">
        SELECT *
              FROM (SELECT rownum rownum_, 
                           b.count_, a.*
                      FROM (SELECT * 
                              FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_clm_loss_exp_list(#claimId#, #payeeType#, #payeeClassCd#, #payeeCd#, #itemNo#, #perilCd#, #clmClmntNo#, #groupedItemNo#, #historySequenceNumber#, #clmLossExpStatDesc#, #adviceAmount#, #netAmount#, #paidAmount#, #remarks#))
                            <isEqual property="sortColumn" compareValue="historySequenceNumber">
                                ORDER BY hist_seq_no
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="clmLossExpStatDesc">
                                ORDER BY le_stat_desc
                              </isEqual>
                            <isEqual property="sortColumn" compareValue="paidAmount">
                                ORDER BY paid_amt
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="netAmount">
                                ORDER BY net_amt
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="adviceAmount">
                                ORDER BY advice_amt
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="remarks">
                                ORDER BY remarks
                              </isEqual>
                            <isNotNull property="sortColumn">
                                  <isEqual property="ascDescFlg" compareValue="ASC">
                                      ASC
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="DESC">
                                      DESC
                                  </isEqual>
                              </isNotNull>) a, 
                           (SELECT count(*) count_
                              FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_clm_loss_exp_list(#claimId#, #payeeType#, #payeeClassCd#, #payeeCd#, #itemNo#, #perilCd#, #clmClmntNo#, #groupedItemNo#, #historySequenceNumber#, #clmLossExpStatDesc#, #adviceAmount#, #netAmount#, #paidAmount#, #remarks#))
                              ) b) WHERE rownum_ BETWEEN #from# AND #to#  
    </select>
    
    <select id="getNextClmLossIdValue" parameterClass="java.lang.Integer" resultClass="java.lang.Integer">
        SELECT GICL_CLM_LOSS_EXP_PKG.get_next_clm_loss_id(#claimId#) next_clm_loss_id FROM dual
    </select>
    
    <procedure id="setGiclClmLossExp" parameterClass="GICLClaimLossExpenseClass">
        BEGIN
            giis_users_pkg.app_user := #userId#;
            GICL_CLM_LOSS_EXP_PKG.set_clm_loss_exp_2
                (#claimId#,        #claimLossId#,    #historySequenceNumber#,  #itemNo#, 
                 #perilCode#,    #groupedItemNo#,  #claimClmntNo#,           #itemStatusCd#,
                 #payeeType#,      #payeeCode#,      #payeeClassCode#,         #exGratiaSw#,
                 #distSw#,         #cancelSw#,       #paidAmount#,             #netAmount#,
                 #adviceAmount#, #remarks#,        #finalTag#,               #userId#);
        END;
    </procedure>
    
    <procedure id="deleteGiclClmLossExp" parameterClass="GICLClaimLossExpenseClass">
        BEGIN
            GICL_CLM_LOSS_EXP_PKG.delete_clm_loss_exp(#claimId#, #claimLossId#);
        END;
    </procedure>
    
    <procedure id="cancelGiclClmLossExp" parameterClass="java.util.HashMap">
        BEGIN
            giis_users_pkg.app_user := #userId#;
            GICL_CLM_LOSS_EXP_PKG.cancel_clm_loss_exp(#claimId#, #histSeqNo#, #itemNo#, #perilCd#, #payeeType#, #payeeClassCd#, #payeeCd#);
        END;
    </procedure>
    
    <procedure id="updateClmLossExpAmts" parameterClass="java.util.HashMap">
        BEGIN
            giis_users_pkg.app_user := #userId#;
            GICL_CLM_LOSS_EXP_PKG.update_clm_loss_exp_amts(#claimId#, #clmLossId#, #adviseAmt#, #paidAmt#, #netAmt#, #userId#);
        END;
    </procedure>
    
    <procedure id="updateClmLossExpAmtsWithTax" parameterClass="java.util.HashMap">
        BEGIN
            giis_users_pkg.app_user := #userId#;
            GICL_CLM_LOSS_EXP_PKG.upd_clm_loss_exp_amts_with_tax(#claimId#, #clmLossId#, #userId#);
        END;
    </procedure>
    
    <select id="validateHistSeqNo" parameterClass="java.util.HashMap" resultClass="java.lang.String">
        SELECT NVL(VALIDATE_HIST_SEQ_NO(#claimId#, #itemNo#, #perilCd#), 'EMPTY') FROM dual
    </select>
    
    <select id="getViewHistoryListing" resultMap="getViewHistoryListingResultMap">
        SELECT *
              FROM (SELECT rownum rownum_, 
                           b.count_, a.*
                      FROM (SELECT * 
                              FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_view_hist_clm_loss_exp(#lineCd#, #claimId#, #itemNo#, #perilCd#, #payeeType#, #payeeClassCd#, #payeeCd#, #historySequenceNumber#, #clmLossExpStatDesc#, #perilSname#, #payee#, #adviceAmount#, #netAmount#, #paidAmount#))
							<isNotNull property="filter">
					      		WHERE 1=1
          			        		<isNotEmpty prepend="AND" property="distSw">
          					  			UPPER(dist_sw) LIKE UPPER(#distSw#)
          			        		</isNotEmpty>
          			        		<isNotEmpty prepend="AND" property="payeeClassCode">
          					  			UPPER(payee_class_cd) LIKE UPPER(#payeeClassCode#)
          			        		</isNotEmpty>
          			        </isNotNull>
                            <isEqual property="sortColumn" compareValue="historySequenceNumber">
                                ORDER BY hist_seq_no
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="clmLossExpStatDesc">
                                ORDER BY le_stat_desc
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="distSw">
                                ORDER BY dist_sw
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="itemNo">
                                ORDER BY item_no
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="perilSname">
                                ORDER BY peril_sname
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="payeeClassCode">
                                ORDER BY payee_class_cd
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="payee">
                                ORDER BY payee_last_name
                              </isEqual>
                            <isEqual property="sortColumn" compareValue="paidAmount">
                                ORDER BY paid_amt
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="netAmount">
                                ORDER BY net_amt
                              </isEqual>
                              <isEqual property="sortColumn" compareValue="adviceAmount">
                                ORDER BY advice_amt
                              </isEqual>
                            <isNotNull property="sortColumn">
                                  <isEqual property="ascDescFlg" compareValue="ASC">
                                      ASC
                                  </isEqual>
                                  <isEqual property="ascDescFlg" compareValue="DESC">
                                      DESC
                                  </isEqual>
                              </isNotNull>) a, 
                           (SELECT count(*) count_
                              FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_view_hist_clm_loss_exp(#lineCd#, #claimId#, #itemNo#, #perilCd#, #payeeType#, #payeeClassCd#, #payeeCd#, #historySequenceNumber#, #clmLossExpStatDesc#, #perilSname#, #payee#, #adviceAmount#, #netAmount#, #paidAmount#))
                              	<isNotNull property="filter">
					      			WHERE 1=1
          			        		<isNotEmpty prepend="AND" property="distSw">
          					  			UPPER(dist_sw) LIKE UPPER(#distSw#)
          			        		</isNotEmpty>
          			        		<isNotEmpty prepend="AND" property="payeeClassCode">
          					  			UPPER(payee_class_cd) LIKE UPPER(#payeeClassCode#)
          			        		</isNotEmpty>
          			        	</isNotNull>) b) 
        WHERE rownum_ BETWEEN #from# AND #to#
    </select>
    
    <select id="getGenAccClmLossExp" resultMap="GenAccLossExpTaxResultMap">
        SELECT * FROM TABLE(gicl_clm_loss_exp_pkg.get_gen_acc_clm_loss(#claimId#, #adviceId#))
    </select>
    
    <procedure id="valClmLossExpTax" parameterMap="ValClmLossExpTaxParamMap">
        BEGIN
            gicl_clm_loss_exp_pkg.val_clm_loss_exp_tax(?, ?, ?, ?);
        END;
    </procedure>
    
    <procedure id="copyHistory" parameterMap="copyHistoryParamMap">
        BEGIN
            giis_users_pkg.app_user := ?;
            COPY_HISTORY(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
        END;
    </procedure>
    
    <select id="getLOATableGridList" resultMap="loaCslListResultMap">
        SELECT *
          FROM (SELECT rownum rownum_, 
                       b.count_, a.*
                  FROM (SELECT * 
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_loa_list(#claimId#))
                        <isEqual property="sortColumn" compareValue="histSeqNo">
                            ORDER BY hist_seq_no
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="paidAmt">
                            ORDER BY paid_amt
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="loaNo">
                            ORDER BY loa_no
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="classDesc payeeName">
                            ORDER BY class_desc
                            		<isNotNull property="sortColumn">
			                              <isEqual property="ascDescFlg" compareValue="ASC">
			                                  ASC
			                              </isEqual>
			                              <isEqual property="ascDescFlg" compareValue="DESC">
			                                  DESC
			                              </isEqual>
			                         </isNotNull>
			                        , payee_name
                          </isEqual>
                          <isNotNull property="sortColumn">
                              <isEqual property="ascDescFlg" compareValue="ASC">
                                  ASC
                              </isEqual>
                              <isEqual property="ascDescFlg" compareValue="DESC">
                                  DESC
                              </isEqual>
                          </isNotNull>
                        ) a, 
                       (SELECT count(*) count_
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_loa_list(#claimId#))
                          ) b) 
         WHERE rownum_ BETWEEN #from# AND #to#
    </select>
    
    <select id="getCSLTableGridList" resultMap="loaCslListResultMap">
        SELECT *
          FROM (SELECT rownum rownum_, 
                       b.count_, a.*
                  FROM (SELECT * 
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_csl_list(#claimId#))
                        <isEqual property="sortColumn" compareValue="histSeqNo">
                            ORDER BY hist_seq_no
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="paidAmt">
                            ORDER BY paid_amt
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="cslNo">
                            ORDER BY csl_no
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="classDesc payeeName">
                            ORDER BY class_desc
                            		 <isNotNull property="sortColumn">
			                              <isEqual property="ascDescFlg" compareValue="ASC">
			                                  ASC
			                              </isEqual>
			                              <isEqual property="ascDescFlg" compareValue="DESC">
			                                  DESC
			                              </isEqual>
			                         </isNotNull>
			                        , payee_name
                          </isEqual>
                          <isNotNull property="sortColumn">
                              <isEqual property="ascDescFlg" compareValue="ASC">
                                  ASC
                              </isEqual>
                              <isEqual property="ascDescFlg" compareValue="DESC">
                                  DESC
                              </isEqual>
                          </isNotNull>
                        ) a, 
                       (SELECT count(*) count_
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_csl_list(#claimId#))
                          ) b) 
         WHERE rownum_ BETWEEN #from# AND #to#
    </select>
    
    <select id="getFLADistDtls" resultMap="flaDistDtlsMap">
        SELECT *
          FROM (SELECT rownum rownum_, 
                       b.count_, a.*
                  FROM (SELECT * 
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_gicls033_dist_dtls(#claimId#, #adviceId#, #lineCd#))
                        <isEqual property="sortColumn" compareValue="trtyName">
                            ORDER BY trty_name
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="paidAmt">
                            ORDER BY paid_amt
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="netAmt">
                            ORDER BY net_amt
                          </isEqual>
                          <isEqual property="sortColumn" compareValue="advAmt">
                            ORDER BY adv_amt
                          </isEqual>
                          <isNotNull property="sortColumn">
                              <isEqual property="ascDescFlg" compareValue="ASC">
                                  ASC
                              </isEqual>
                              <isEqual property="ascDescFlg" compareValue="DESC">
                                  DESC
                              </isEqual>
                          </isNotNull>
                        ) a, 
                       (SELECT count(*) count_
                          FROM TABLE (GICL_CLM_LOSS_EXP_PKG.get_gicls033_dist_dtls(#claimId#, #adviceId#, #lineCd#))
                          ) b) 
         WHERE rownum_ BETWEEN #from# AND #to#
    </select>
    
    <!-- J. Diago 09.02.2013 -->
	<resultMap class="java.util.HashMap" id="getLossExpenseListingMap" extends="BaseEntity.TableGridResultMap">
	    <result property="claimNo"         				column="claim_no"/>
	    <result property="policyNo"         			column="policy_no"/>
	    <result property="histSeqNo"         			column="hist_seq_no"/>
	    <result property="itemStatCd"         			column="item_stat_cd"/>
	    <result property="itemNo"         				column="item_no"/>
	    <result property="groupedItemNo"         		column="grouped_item_no"/>
	    <result property="perilCd"         				column="peril_cd"/>
	    <result property="dspPerilSname"         		column="dsp_peril_sname"/>
	    <result property="currencyCd"         			column="currency_cd"/>
	    <result property="currencyRate"         		column="currency_rate"/>
	    <result property="payeeType"         			column="payee_type"/>
	    <result property="payeeCd"         				column="payee_cd"/>
	    <result property="dspPayeeName"         		column="dsp_payee_name"/>
	    <result property="paidAmt"         				column="paid_amt"/>
	    <result property="netAmt"         				column="net_amt"/>
	    <result property="adviseAmt"         			column="advise_amt"/>
	    <result property="lineCd"         				column="line_cd"/>
	    <result property="sublineCd"         			column="subline_cd"/>
	    <result property="issCd"         				column="iss_cd"/>
	    <result property="clmYy"         				column="clm_yy"/>
	    <result property="clmSeqNo"         			column="clm_seq_no"/>
	    <result property="polIssCd"         			column="pol_iss_cd"/>
	    <result property="issueYy"         				column="issue_yy"/>
	    <result property="polSeqNo"         			column="pol_seq_no"/>
	    <result property="renewNo"         				column="renew_no"/>
	    <result property="claimId"         				column="claim_id"/>
	    <result property="clmLossId"         			column="clm_loss_id"/>
	    <result property="lossDate"         			column="loss_date"/>
	    <result property="effDate"         				column="eff_date"/>
	    <result property="expiryDate"         			column="expiry_date"/>
	    <result property="catastrophicCd"         		column="catastrophic_cd"/>
	    <result property="distRg"         		        column="dist_rg"/>
	    <result property="clmFileDate"         			column="clm_file_date"/>
	    <result column="rownum_" 						property="rowNum" />
		<result column="count_"							property="rowCount" />
	</resultMap>
	
	<select id="getLossExpenseListing" resultMap="getLossExpenseListingMap">
		SELECT *
  	      FROM (SELECT ROWNUM rownum_, b.count_, a.*
                  FROM (SELECT *
                          FROM TABLE (gicls038_pkg.get_lossexpense_list(#lineCd#, #userId#))
                         WHERE UPPER (subline_cd) LIKE UPPER (NVL (#sublineCd#, subline_cd))
                           AND UPPER (iss_cd) LIKE UPPER (NVL (#issCd#, iss_cd))
                           AND UPPER (clm_yy) LIKE UPPER (NVL (#clmYy#, clm_yy))
                           AND UPPER (clm_seq_no) LIKE UPPER (NVL (#clmSeqNo#, clm_seq_no))
                           AND UPPER (pol_iss_cd) LIKE UPPER (NVL (#polIssCd#, pol_iss_cd))
                           AND UPPER (issue_yy) LIKE UPPER (NVL (#issueYy#, issue_yy))
                           AND UPPER (pol_seq_no) LIKE UPPER (NVL (#polSeqNo#, pol_seq_no))
                           AND UPPER (renew_no) LIKE UPPER (NVL (#renewNo#, renew_no))
                           $andAmount$
                           $andDate$
                        <isEqual property="sortColumn" compareValue="lineCd sublineCd issCd clmYy clmSeqNo">
		              		ORDER BY line_cd, subline_cd, iss_cd, clm_yy, clm_seq_no
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="lineCd sublineCd polIssCd issueYy polSeqNo renewNo">
		              		ORDER BY line_cd, subline_cd, pol_iss_cd, issue_yy, pol_seq_no, renew_no
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="histSeqNo">
		              		ORDER BY hist_seq_no
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="itemStatCd">
		              		ORDER BY item_stat_cd
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="itemNo groupedItemNo">
		              		ORDER BY item_no, grouped_item_no
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="perilCd dspPerilSname">
		              		ORDER BY peril_cd, dsp_peril_sname
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="currencyCd currencyRate">
		              		ORDER BY currency_cd, currency_rate
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="payeeType payeeCd dspPayeeName">
		              		ORDER BY payee_type, payee_cd, dsp_payee_name
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="paidAmt">
		              		ORDER BY paid_amt
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="netAmt">
		              		ORDER BY net_amt
			            </isEqual>
			            <isEqual property="sortColumn" compareValue="adviseAmt">
		              		ORDER BY advise_amt
			            </isEqual>
			            <isNotNull property="sortColumn">
		              		<isEqual property="ascDescFlg" compareValue="ASC">
		              			ASC
		              		</isEqual>
		              		<isEqual property="ascDescFlg" compareValue="DESC">
		              			DESC
		              		</isEqual>
		              	</isNotNull>
                          ) a,
               (SELECT COUNT (*) count_
                  FROM TABLE (gicls038_pkg.get_lossexpense_list(#lineCd#, #userId#))
                 WHERE UPPER (subline_cd) LIKE UPPER (NVL (#sublineCd#, subline_cd))
                   AND UPPER (iss_cd) LIKE UPPER (NVL (#issCd#, iss_cd))
                   AND UPPER (clm_yy) LIKE UPPER (NVL (#clmYy#, clm_yy))
                   AND UPPER (clm_seq_no) LIKE UPPER (NVL (#clmSeqNo#, clm_seq_no))
                   AND UPPER (pol_iss_cd) LIKE UPPER (NVL (#polIssCd#, pol_iss_cd))
                   AND UPPER (issue_yy) LIKE UPPER (NVL (#issueYy#, issue_yy))
                   AND UPPER (pol_seq_no) LIKE UPPER (NVL (#polSeqNo#, pol_seq_no))
                   AND UPPER (renew_no) LIKE UPPER (NVL (#renewNo#, renew_no))
                   $andAmount$
                   $andDate$
                  ) b)
         WHERE rownum_ BETWEEN #from# AND #to#
	</select>
	
	<parameterMap class="map" id="redistributeLossExpenseGICLS038Map">
	    <parameter property="claimId"		  		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="clmLossId"		  		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="distRg"		  		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="itemNo"		  		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="perilCd"		  		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="groupedItemNo"		  	jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="lossDate"		  	    jdbcType="DATE"	    javaType="java.util.Date"	    mode="IN"/>
	    <parameter property="effDate"		  	    jdbcType="DATE"	    javaType="java.util.Date"	    mode="IN"/>
	    <parameter property="expiryDate"		  	jdbcType="DATE"	    javaType="java.util.Date"	    mode="IN"/>
	    <parameter property="lineCd"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="sublineCd"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="polIssCd"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="issueYy"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="polSeqNo"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="renewNo"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="distDate"		  		jdbcType="DATE"	    javaType="java.util.Date"	    mode="IN"/>
	    <parameter property="payeeCd"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="histSeqNo"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="payeeType"		  	    jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="catastrophicCd"		jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="IN"/>
	    <parameter property="pMessage"		        jdbcType="VARCHAR"	javaType="java.lang.String"	    mode="OUT"/>
	</parameterMap>
	
	<procedure id="redistributeLossExpenseGICLS038" parameterMap="redistributeLossExpenseGICLS038Map">
		CALL REDISTRIBUTE_LOSS_EXP.DIST_CLM_RECORDS(TO_NUMBER(?), TO_NUMBER(?), ?, TO_NUMBER(?), TO_NUMBER(?),
		                                            TO_NUMBER(?), ?, ?, ?, ?,
		                                            ?, ?, TO_NUMBER(?), TO_NUMBER(?), TO_NUMBER(?),
		                                            ?, TO_NUMBER(?), TO_NUMBER(?), ?, TO_NUMBER(?), ?)
	</procedure>
	
	<!-- Kenneth 06162015 SR 3616 -->
	 <procedure id="checkHistoryNumber" parameterClass="java.util.HashMap">
		BEGIN
        	GICL_CLM_LOSS_EXP_PKG.check_hist_seq_no(#claimId#, #itemNo#, #perilCd#, #groupedItemNo#, #payeeType#,  #payeeClassCd#, #payeeCd#, #histSeqNo#);
        END;
    </procedure>
    
    <resultMap class="java.util.HashMap" id="giclClmLossExpMap">
		<result column="claim_id"    	property="claimId"/>
		<result column="clm_loss_id"  	property="clmLossId"/>
		<result column="paid_amt"     	property="paidAmt"/>
		<result column="paid_amt2"     	property="paidAmt2"/>
		<result column="net_amt"     	property="netAmt"/>
		<result column="currency_rate"	property="currencyRate"/>
		<result column="currency_cd"    property="currencyCd"/>
		<result column="payee_type"     property="payeeType"/>
		<result column="conv_rt"    	property="convRt"/> 	 <!-- nieko :: 01192017 :: SR 5901 -->
		<result column="convert_rate"   property="convertRate"/> <!-- nieko :: 01192017 :: SR 5901 -->
	</resultMap>
	
	<!-- <select id="getGiclClmLossExp" resultMap="giclClmLossExpMap">
		SELECT *
		  FROM gicl_clm_loss_exp
		 WHERE claim_id = #claimId#
	</select> -->	
	
	<!-- bonok :: 12.14.2015 :: UCPB SR 21147 -->
<!-- 	<select id="getGiclClmLossExp" resultMap="giclClmLossExpMap">
		SELECT *
		  FROM gicl_clm_loss_exp
		 WHERE claim_id = #claimId#
		   AND advice_id = #adviceId#
	</select>	 -->
	
	<!-- bonok :: 2.22.2016 :: UCPB SR 21664 -->
	<!-- <select id="getGiclClmLossExp" resultMap="giclClmLossExpMap">
		SELECT a.claim_id, a.clm_loss_id, a.paid_amt, ROUND(a.paid_amt * NVL(b.orig_curr_rate, convert_rate), 2) paid_amt2, a.net_amt, a.currency_rate, a.currency_cd, a.payee_type 
		  FROM gicl_clm_loss_exp a, gicl_advice b
		 WHERE a.claim_id = #claimId#
		   AND a.advice_id = #adviceId#
		   AND a.claim_id = b.claim_id
		   AND a.advice_id = b.advice_id
	</select>	 nieko :: 01192017 :: SR 5901 -->
    
    <!-- nieko :: 01192017 :: SR 5901 -->
	<select id="getGiclClmLossExp" resultMap="giclClmLossExpMap">
		SELECT a.claim_id, a.clm_loss_id, a.paid_amt, ROUND(a.paid_amt * NVL(b.orig_curr_rate, convert_rate), 2) paid_amt2, a.net_amt, a.currency_rate, a.currency_cd, a.payee_type,
       		   DECODE (a.currency_cd, giacp.n ('CURRENCY_CD'), 1, NVL (b.orig_curr_rate, b.convert_rate)) conv_rt,
       		   DECODE (b.currency_cd, giacp.n ('CURRENCY_CD'), 1, NVL (b.orig_curr_rate, b.convert_rate)) convert_rate 
		  FROM gicl_clm_loss_exp a, gicl_advice b
		 WHERE a.claim_id = #claimId#
		   AND a.advice_id = #adviceId#
		   AND a.claim_id = b.claim_id
		   AND a.advice_id = b.advice_id
	</select>
</sqlMap>